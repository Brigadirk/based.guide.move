{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://basedguide.ai/schemas/profile_schema.json",
  "title": "Relocation Tax Profile",
  "description": "Unified schema describing every field produced by the Streamlit questionnaire.",
  "type": "object",
  "required": [
    "personalInformation",
    "education",
    "residencyIntentions",
    "finance",
    "socialSecurityAndPensions",
    "futureFinancialPlans",
    "taxDeductionsAndCredits",
    "additionalInformation"
  ],
  "properties": {
    "personalInformation": {
      "$ref": "#/definitions/personalInformation"
    },
    "education": {
      "$ref": "#/definitions/education"
    },
    "residencyIntentions": {
      "$ref": "#/definitions/residencyIntentions"
    },
    "finance": {
      "$ref": "#/definitions/finance"
    },
    "socialSecurityAndPensions": {
      "$ref": "#/definitions/socialSecurityAndPensions"
    },
    "futureFinancialPlans": {
      "$ref": "#/definitions/futureFinancialPlans"
    },
    "taxDeductionsAndCredits": {
      "$ref": "#/definitions/taxDeductionsAndCredits"
    },
    "additionalInformation": {
      "$ref": "#/definitions/additionalInformation"
    }
  },
  "definitions": {
    "personalInformation": {
      "type": "object",
      "required": ["dateOfBirth", "currentResidency", "nationalities"],
      "properties": {
        "dateOfBirth": {"type": "string", "format": "date"},
        "nationalities": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["country", "willingToRenounce"],
            "properties": {
              "country": {"type": "string"},
              "willingToRenounce": {"type": "boolean"}
            }
          }
        },
        "maritalStatus": {"type": "string", "enum": ["Single", "Official Partnership", "Married", "Divorced", "Widowed", ""]},
        "currentResidency": {
          "type": "object",
          "required": ["country", "status"],
          "properties": {
            "country": {"type": "string"},
            "status": {"type": "string", "enum": ["Citizen", "Permanent Resident", "Temporary Resident"]},
            "duration": {"type": "number", "minimum": 0}
          }
        },
        "relocationPartner": {"type": "boolean"},
        "relocationPartnerInfo": {
          "type": "object",
          "properties": {
            "relationshipType": {"type": "string"},
            "sameSex": {"type": "boolean"},
            "fullRelationshipDuration": {"type": "number", "minimum": 0},
            "officialRelationshipDuration": {"type": "number", "minimum": 0},
            "partnerNationalities": {"type": "array", "items": {"type": "object", "properties": {"country": {"type": "string"}}}}
          }
        },
        "numRelocationDependents": {"type": "integer", "minimum": 0},
        "relocationDependents": {"type": "array", "items": {"type": "object"}}
      }
    },

    "education": {
      "type": "object",
      "properties": {
        "isStudent": {"type": "boolean"},
        "currentSchool": {"type": "string"},
        "currentFieldOfStudy": {"type": "string"},
        "previousDegrees": {"type": "array", "items": {"type": "object"}},
        "visaSkills": {"type": "array", "items": {"type": "object"}},
        "interestedInStudying": {"type": "boolean"},
        "schoolInterestDetails": {"type": "string"},
        "militaryService": {
          "type": "object",
          "properties": {
            "hasService": {"type": "boolean"},
            "country": {"type": "string"},
            "branch": {"type": "string"}
          }
        }
      }
    },

    "residencyIntentions": {
      "type": "object",
      "required": ["destinationCountry"],
      "properties": {
        "destinationCountry": {
          "type": "object",
          "required": ["country", "moveType"],
          "properties": {
            "country": {"type": "string"},
            "moveType": {"type": "string"},
            "intendedTemporaryDurationOfStay": {"type": "number", "minimum": 1},
            "citizenshipStatus": {"type": "boolean"}
          }
        },
        "residencyPlans": {
          "type": "object",
          "properties": {
            "applyForResidency": {"type": "boolean"},
            "maxMonthsWillingToReside": {"type": "number", "minimum": 1},
            "openToVisiting": {"type": "boolean"}
          }
        },
        "citizenshipPlans": {
          "type": "object",
          "properties": {
            "interestedInCitizenship": {"type": "boolean"},
            "familyTies": {"type": "object"},
            "investment": {"type": "object"},
            "donation": {"type": "object"}
          }
        },
        "languageSkills": {
          "type": "object",
          "properties": {
            "currentProficiency": {"type": "object"},
            "interestedInLearning": {"type": "boolean"},
            "learningCommitment": {"type": "object"}
          }
        },
        "motivationAndCompliance": {
          "type": "object",
          "properties": {
            "motivations": {"type": "array", "items": {"type": "string"}},
            "complianceCommitment": {"type": "object"}
          }
        },
        "familyVisaPlanning": {
          "type": "object",
          "properties": {
            "applicationTimeline": {
              "type": "string",
              "enum": ["together", "sequential", "flexible"]
            },
            "relocationPriority": {
              "type": "string", 
              "enum": ["moveTogetherEssential", "primaryFirstAcceptable", "flexibleTiming"]
            },
            "concerns": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["documentPreparation", "applicationCosts", "processingTiming", "childSchooling", "spouseWork"]
              }
            },
            "specialCircumstances": {"type": "string"}
          }
        },
        "alternativeInterests": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["culturalIntegration", "healthcareSystem", "educationSystem", "employmentMarket", "housingMarket", "socialServices", "legalRequirements", "costOfLiving"]
          }
        },
        "specificQuestions": {"type": "string"},
        "informationDepth": {
          "type": "string",
          "enum": ["overview", "practical", "detailed"]
        }
      }
    },

    "finance": {
      "type": "object",
      "properties": {
        "skipDetails": {"type": "boolean"},
        "incomeSituation": {"type": "string"},
        "totalWealth": {
          "type": "object",
          "properties": {
            "currency": {"type": "string", "pattern": "^[A-Z]{3}$"},
            "total": {"type": "number", "minimum": 0},
            "primaryResidence": {"type": "number", "minimum": 0}
          }
        },
        "incomeSources": {"type": "array", "items": {"type": "object"}},
        "expectedEmployment": {"type": "array", "items": {"type": "object"}},
        "liabilities": {"type": "array", "items": {"type": "object"}},
        "capitalGains": {"type": "array", "items": {"type": "object"}},
        "assets": {"type": "array", "items": {"type": "object"}}
      }
    },

    "socialSecurityAndPensions": {
      "type": "object",
      "properties": {
        "currentCountryContributions": {
          "type": "object",
          "properties": {
            "isContributing": {"type": "boolean"},
            "country": {"type": "string"},
            "yearsOfContribution": {"type": "number", "minimum": 0}
          }
        },
        "futurePensionContributions": {
          "type": "object",
          "properties": {
            "isPlanning": {"type": "boolean"},
            "details": {"type": "array", "items": {"type": "object"}}
          }
        },
        "existingPlans": {
          "type": "object",
          "properties": {
            "hasPlans": {"type": "boolean"},
            "details": {"type": "array", "items": {"type": "object"}}
          }
        }
      }
    },
    "futureFinancialPlans": {
      "type": "object",
      "properties": {
        "plannedInvestments": {"type": "array", "items": {"type": "object"}},
        "plannedPropertyTransactions": {"type": "array", "items": {"type": "object"}},
        "plannedRetirementContributions": {"type": "array", "items": {"type": "object"}},
        "plannedBusinessChanges": {"type": "array", "items": {"type": "object"}}
      }
    },
    "taxDeductionsAndCredits": {
      "type": "object",
      "properties": {
        "potentialDeductions": {"type": "array", "items": {"type": "object"}}
      }
    },
    "additionalInformation": {
      "type": "object",
      "properties": {
        "generalNotes": {"type": "string"},
        "specialSections": {"type": "array", "items": {"type": "string"}}
      }
    }
  }
} 